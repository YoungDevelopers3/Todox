<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Vibe Productivity Tracker üåà</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg: #181a1b;
        --primary: #00e1ff;
        --accent: #d726ff;
        --frost: rgba(25, 25, 40, 0.93);
        --glass: rgba(34, 38, 56, 0.72);
        --shadow: 0 2px 54px 2px #00f7ff44;
        --gradient: linear-gradient(90deg, #00e1ff 0%, #d726ff 100%);
        --border-radius: 22px;
      }
      html {
        box-sizing: border-box;
      }
      *,
      *:before,
      *:after {
        box-sizing: inherit;
      }
      body {
        background: var(--bg);
        color: #f3f4f6;
        font-family: "Inter", Arial, sans-serif;
        margin: 0;
        min-height: 100vh;
        padding: 0;
        background-image: radial-gradient(
          ellipse at 60% 18%,
          #00e1ff11 0%,
          #d726ff00 100%
        );
        letter-spacing: -0.01em;
      }
      .container {
        max-width: 650px;
        margin: 40px auto 24px;
        background: var(--frost);
        border-radius: var(--border-radius);
        padding: 38px 20px 30px;
        box-shadow: var(--shadow);
        backdrop-filter: blur(16px);
        border: 1.5px solid #2cd5ff30;
        position: relative;
      }
      header {
        text-align: center;
        margin-bottom: 34px;
      }
      h1 {
        font-size: 2.2em;
        font-weight: 700;
        margin-bottom: 7px;
        background: var(--gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        letter-spacing: 1px;
      }
      .quote {
        font-weight: 500;
        color: #fbe1fa;
        font-size: 1.08em;
        margin-top: 8px;
        margin-bottom: 0;
        text-shadow: 0 0 7px #00e1ff70;
      }
      #date {
        color: #6cf2e5;
        margin-top: 5px;
        font-size: 1.12em;
        opacity: 0.83;
      }
      .streak-section {
        margin: 23px 0 8px 0;
        background: var(--glass);
        border-radius: 16px;
        padding: 18px 14px 12px;
        box-shadow: 0 2px 16px 1px #00e1ff13;
      }
      .streak-label {
        font-size: 1em;
        color: #90caf9;
        font-weight: 700;
        margin-bottom: 9px;
        text-align: left;
        margin-left: 5px;
      }
      .heatmap {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 4px;
        margin-bottom: 6px;
      }
      .heatcell {
        width: 21px;
        height: 21px;
        border-radius: 6px;
        background: #233;
        border: 1.5px solid #202a36;
        transition: background 0.2s;
        box-sizing: border-box;
      }
      .heatcell.lv0 {
        background: #313347;
      }
      .heatcell.lv1 {
        background: #1ce1ff33;
      }
      .heatcell.lv2 {
        background: #1ce1ff99;
      }
      .heatcell.lv3 {
        background: #1fd0ea;
      }
      .heatcell.lv4 {
        background: #00e1ff;
        box-shadow: 0 0 8px #00e1ff80;
        border: 1.5px solid #5beaff;
      }
      .heatcell.today {
        border: 2.5px solid var(--accent);
      }
      .streak-info {
        font-size: 0.98em;
        color: #b89cff;
        margin-left: 5px;
        margin-bottom: 2px;
      }
      .task-list {
        margin-top: 23px;
        margin-bottom: 20px;
        display: flex;
        flex-direction: column;
        gap: 22px;
      }
      .task-block {
        background: var(--glass);
        border-radius: 15px;
        padding: 19px 16px 10px 16px;
        margin-bottom: 0;
        box-shadow: 0 1px 13px #67e8f930;
        border: 1px solid #5ffaf630;
      }
      .task-block h2 {
        margin: 0 0 12px 0;
        font-size: 1.15em;
        font-weight: 700;
        color: #6df5fd;
        letter-spacing: 0.4px;
        text-shadow: 0 0 9px #00e1ff26;
      }
      ul {
        list-style: none;
        margin: 0;
        padding: 0;
      }
      label {
        display: flex;
        align-items: center;
        gap: 14px;
        margin-bottom: 7px;
        font-size: 1em;
        cursor: pointer;
        transition: color 0.2s;
      }
      input[type="checkbox"] {
        accent-color: var(--primary);
        width: 1.18em;
        height: 1.18em;
        border: 1.5px solid #68e0fa;
        background: #1c2130;
      }
      .master-check-section {
        margin: 22px 0 14px 0;
        padding: 13px 20px 7px 10px;
        border-radius: 12px;
        background: var(--glass);
        box-shadow: 0 1px 8px #67e8f930;
        border: 1px solid #5ffaf620;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }
      .master-check-label {
        font-weight: 700;
        color: #b8f3f7;
        font-size: 1.07em;
        letter-spacing: 0.04em;
        display: flex;
        align-items: center;
        gap: 10px;
      }
      #masterCheck {
        width: 1.25em;
        height: 1.25em;
      }
      .notes-section {
        margin: 21px 0 0 0;
        background: var(--glass);
        border-radius: 13px;
        padding: 17px 0 12px 0;
        box-shadow: 0 1px 13px #3b69d330;
        border: 1px solid #cbf6ff33;
      }
      .notes-label {
        color: #75fffa;
        font-weight: 700;
        margin: 0 20px 7px 22px;
        font-size: 1.07em;
      }
      .notes-box {
        width: 92%;
        margin: 0 4% 5px 4%;
        background: #24273bcc;
        color: #efffff;
        border: 1.5px solid #00e1ff80;
        border-radius: 9px;
        min-height: 64px;
        max-height: 150px;
        outline: none;
        font-size: 1em;
        font-family: "Inter", Arial, sans-serif;
        padding: 9px 8px;
        margin-bottom: 0;
        resize: vertical;
        box-shadow: 0 1px 8px #67e8f928;
        transition: border 0.2s;
      }
      @media (max-width: 720px) {
        .container {
          padding: 19px 2vw 19px;
          max-width: 98vw;
        }
        .notes-box {
          font-size: 0.96em;
        }
        .task-block {
          padding: 13px 7px 8px 9px;
        }
        .streak-section,
        .notes-section,
        .master-check-section {
          padding-left: 4vw;
          padding-right: 3vw;
        }
      }
      ::selection {
        background: #00e1ff44;
      }
      /* for nice hover tickbox */
      input[type="checkbox"]:hover {
        box-shadow: 0 0 9px #00e1ff76;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>Vibe Productivity Tracker üåà</h1>
        <div class="quote" id="quote"></div>
        <div id="date"></div>
      </header>
      <!-- Streak Chart -->
      <div class="streak-section">
        <div class="streak-label">Monthly Productivity Chart & Streak</div>
        <div class="heatmap" id="heatmap"></div>
        <div class="streak-info" id="streakInfo"></div>
      </div>
      <!-- Master Completion Checkbox -->
      <section class="master-check-section">
        <span class="master-check-label">
          <input type="checkbox" id="masterCheck" />
          <span>All Items Complete for Today</span>
        </span>
        <span id="masterCheckMsg"></span>
      </section>
      <!-- Tasks -->
      <div class="task-list" id="tasks"></div>
      <!-- Notes -->
      <div class="notes-section">
        <div class="notes-label">Notes & Reminders for Today</div>
        <textarea
          class="notes-box"
          id="notesBox"
          placeholder="Type your reminders here..."
        ></textarea>
      </div>
    </div>
    <script>
      // DSA Week topics (auto-select by week number)
      const dsaWeeks = [
        "Arrays",
        "Strings",
        "Binary Search",
        "Stack & Queue",
        "2 Pointers",
      ];

      // Motivational quotes (rotates daily)
      const quotes = [
        "Push yourself, because no one else is going to do it for you.",
        "Discipline > Motivation. The grind never lies.",
        "Work in silence; let your success make the noise.",
        "Dream big, hustle harder.",
        "Success is earned, not given.",
        "Don‚Äôt stop until you‚Äôre proud.",
        "It's not about having time. It's about making time.",
        "Action is the foundational key to all success.",
        "Strive for progress, not perfection.",
        "Consistency is what transforms average into excellence.",
        "Don‚Äôt wish for it. Work for it.",
        "Every accomplishment starts with the decision to try.",
        "Fortune favors the brave.",
        "Make it happen. Shock everyone.",
        "Small steps every day.",
      ];
      // Get a different quote depending on current day-of-year
      function getDailyQuote() {
        const now = new Date();
        const day = Math.floor(
          (now - new Date(now.getFullYear(), 0, 0)) / 86400000
        );
        return quotes[day % quotes.length];
      }
      document.getElementById("quote").textContent = `‚Äú${getDailyQuote()}‚Äù`;

      // Date UI
      function updateDate() {
        const d = new Date();
        document.getElementById("date").textContent = d.toLocaleString(
          undefined,
          {
            weekday: "long",
            month: "short",
            day: "2-digit",
            year: "numeric",
            hour: "2-digit",
            minute: "2-digit",
          }
        );
      }
      updateDate();
      setInterval(updateDate, 60 * 1000);

      // --- Task logic ---
      function getWeekNumber() {
        const now = new Date();
        const startOfYear = new Date(now.getFullYear(), 0, 1);
        const pastDays = Math.floor((now - startOfYear) / 86400000);
        return Math.ceil(pastDays / 7);
      }
      function dsaTopicOfWeek() {
        const week = getWeekNumber();
        return dsaWeeks[(week - 1) % dsaWeeks.length];
      }
      // Define tracked tasks & subtasks
      const tasks = [
        {
          title: "Fitness (2hr)",
          subtasks: ["Running", "Stretching"],
        },
        {
          title: () => `DSA Practice (6hr) - ${dsaTopicOfWeek()}`,
          subtasks: [
            () => `New Topic Study: ${dsaTopicOfWeek()}`,
            () => `Questions from Resource (${dsaTopicOfWeek()})`,
            () => `1 New Medium Q: ${dsaTopicOfWeek()} (Striver's Sheet)`,
            () => `1 Previously Done Q: ${dsaTopicOfWeek()}`,
            () => `1 Q from TLE Eliminators: ${dsaTopicOfWeek()}`,
          ],
        },
        {
          title: "JavaScript Practice (2hr) [Chai aur Code]",
          subtasks: ["Session Complete"],
        },
        {
          title: "Maths Practice (2hr)",
          subtasks: ["Session Complete"],
        },
      ];

      // Storage helpers
      const todayStr = () => {
        const now = new Date();
        return `${now.getFullYear()}-${now.getMonth() + 1}-${now.getDate()}`;
      };
      function storageKey(id) {
        return `${todayStr()}_${id}`;
      }
      function markDone(id, val) {
        localStorage.setItem(storageKey(id), val);
      }
      function getDone(id) {
        return localStorage.getItem(storageKey(id)) === "true";
      }
      function clearOldData() {
        // Optionally, delete per-checkbox data older than 40 days from localStorage
        const now = new Date();
        for (let k in localStorage) {
          if (k.match(/^\d{4}-/)) {
            let dt = k.split("_")[0];
            let t = new Date(dt);
            if (now - t > 45 * 86400000) localStorage.removeItem(k);
          }
        }
      }
      clearOldData();

      // Render Tasks + Subtasks
      function renderTasks() {
        const taskList = document.getElementById("tasks");
        taskList.innerHTML = "";
        let ids = [];
        tasks.forEach((block, i) => {
          const blockDiv = document.createElement("div");
          blockDiv.className = "task-block";
          const h2 = document.createElement("h2");
          h2.textContent =
            typeof block.title === "function" ? block.title() : block.title;
          blockDiv.appendChild(h2);

          const ul = document.createElement("ul");
          const subtasks = block.subtasks.map((st) =>
            typeof st === "function" ? st() : st
          );
          subtasks.forEach((task, j) => {
            const li = document.createElement("li");
            const id = `c${i}_${j}`;
            ids.push(id);
            const checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.id = id;
            checkbox.checked = getDone(id);
            checkbox.addEventListener("change", () => {
              markDone(id, checkbox.checked);
              renderMasterCheck();
              renderHeatmap(); // update visual stats
            });
            const label = document.createElement("label");
            label.appendChild(checkbox);
            label.appendChild(document.createTextNode(task));
            li.appendChild(label);
            ul.appendChild(li);
          });
          blockDiv.appendChild(ul);
          taskList.appendChild(blockDiv);
        });
        // Cache all task/subtask IDs so masterCheckbox can use
        window._taskIDs = ids;
      }
      // Master completion checkbox
      function renderMasterCheck() {
        const master = document.getElementById("masterCheck");
        // Count total tasks
        const ids = window._taskIDs || [];
        const done = ids.every((id) => getDone(id));
        master.checked = done;
        master.indeterminate = !done && ids.some((id) => getDone(id));
        // Visual msg based on streak
        const msg = document.getElementById("masterCheckMsg");
        msg.innerHTML = master.checked
          ? '<span style="color:#00e1ff;font-weight:700;">üî• All Done!</span>'
          : '<span style="color:#ff7bf7;">Keep hustling!</span>';
      }
      function masterCheckboxEvents() {
        const master = document.getElementById("masterCheck");
        master.addEventListener("change", () => {
          const checked = master.checked;
          (window._taskIDs || []).forEach((id) => {
            markDone(id, checked);
          });
          renderTasks();
          renderMasterCheck();
          renderHeatmap();
        });
      }

      // --- Notes/Reminders ---
      function renderNotes() {
        const box = document.getElementById("notesBox");
        box.value = localStorage.getItem(storageKey("notes")) || "";
        box.addEventListener("input", () => {
          localStorage.setItem(storageKey("notes"), box.value);
        });
      }

      // --- Heatmap productivity navigator ---
      // For last 35 days, map how many subtasks were ticked per day, out of N
      function renderHeatmap() {
        const grid = document.getElementById("heatmap");
        grid.innerHTML = "";
        const N = tasks
          .map((t) => t.subtasks.length)
          .reduce((a, b) => a + b, 0);
        let streak = 0,
          maxStreak = 0,
          currentStreak = 0;
        // Use today and past 34 days
        const days = [];
        for (let d = 34; d >= 0; d--) {
          const dt = new Date(Date.now() - d * 86400000);
          days.push(dt);
        }
        let latestDone = false;
        days.forEach((dt) => {
          const dtStr = `${dt.getFullYear()}-${
            dt.getMonth() + 1
          }-${dt.getDate()}`;
          let count = 0;
          for (let i = 0; i < tasks.length; i++) {
            for (let j = 0; j < tasks[i].subtasks.length; j++) {
              const sid = `c${i}_${j}`;
              if (localStorage.getItem(`${dtStr}_${sid}`) === "true") {
                count++;
              }
            }
          }
          // Color level:
          let level = 0;
          if (count == 0) level = 0;
          else if (count < N) level = 1;
          else if (count == N) level = 4; // full
          else if (count > N / 2) level = 3;
          else level = 2;
          // Heatcell
          const cell = document.createElement("div");
          cell.className = "heatcell lv" + level;
          if (dt.toDateString() === new Date().toDateString())
            cell.classList.add("today");
          cell.title = `${dt.toLocaleDateString()}\nDone: ${count}/${N}`;
          grid.appendChild(cell);
          // Streak logic:
          if (count === N) {
            currentStreak++;
          } else {
            if (currentStreak > maxStreak) maxStreak = currentStreak;
            currentStreak = 0;
          }
        });
        if (currentStreak > maxStreak) maxStreak = currentStreak;
        if (currentStreak > 0) streak = currentStreak;
        // Streak info
        document.getElementById(
          "streakInfo"
        ).innerHTML = `<span>Current streak: <span style="color:#00e1ff;font-weight:700;">${streak} day${
          streak === 1 ? "" : "s"
        }</span>
         | Max: <span style="color:#ffd700;">${maxStreak} day${
          maxStreak === 1 ? "" : "s"
        }</span></span>`;
      }

      // Initial Mount
      renderTasks();
      renderMasterCheck();
      masterCheckboxEvents();
      renderNotes();
      renderHeatmap();

      // Restyle on task update
      document.addEventListener("click", function (e) {
        if (e.target.type === "checkbox") {
          renderMasterCheck();
          renderHeatmap();
        }
      });
      // Midnight reset for next day
      let lastDay = todayStr();
      setInterval(() => {
        const nowDay = todayStr();
        if (nowDay !== lastDay) {
          lastDay = nowDay;
          renderTasks();
          renderMasterCheck();
          renderHeatmap();
          renderNotes();
          document.getElementById("quote").textContent = `‚Äú${getDailyQuote()}‚Äù`;
        }
      }, 50 * 1000);
    </script>
  </body>
</html>
